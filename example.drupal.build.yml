#
# Example Drupal Runner build configuration, using ALL the options.
#

# Build details - Git, remotes, Drush, make file etc.
Build:
    git: git@example.com:example/example-project/example-repo.git   # Path to read-accessible Git repository.
    drush-alias: "@site.dev"                                        # Alias used to run remote Drush commands.
    profile: minimal                                                # Which profile to use when installing Drupal.
    sites-subdir: mysite                                            # Subdirectory of sites/ in which this site resides.
    make: make/mysite.make                                          # Location of make file relative to sites subdirectory.
    make-path: profiles/myprofile                                   # Optional path to the make file, if not in the sites subdirectory.
    make-options:                                                   # Array of make options (see drush help make).
        contrib-destination: "sites/all"
    sites:                                                          # These sites patterns will be added to $sites.php
        - 8080.mysite.drupal.dev                                    #   and pointed to the main sites-subdir.
        - mysite.stage.example.com
        - mysite.prod.example.com

# Site details - name and root user credentials.
Site:
    name: My Site                                                   # Site name.
    rootuser: root                                                  # 'Root' user name (uid = 1).
    rootpassword: root                                              # 'Root' user password.
    theme: bootstrap_mysite                                         # Theme to enable and set as default. Bartik will be disabled.

# Database details.
Database:
    name: dbname                                                    # Default database name.
    user: root                                                      # Database username.
    password: password                                              # Database password.

# Pre-steps.
Pre:
    Modules:                                                        # Modules to enable before anything else.
        - mysite_block_install
        - features
        - mysite_controller
        - mysite_dev
        - mysite_deploy
    Commands:                                                       # Drush commands to run before anything else.
        - vset views_ui_show_master_display 1
        - vset views_ui_show_advanced_help_warning 0

# Features to enable.
Features:
    - mysite_contact_form
    - mysite_content_type

# Migration.
Migrate:
    # Note we assume that Migrate and Migrate UI are required.
    Dependencies:
        - migrate_d2d
        - migrate_extras
        - migrate_mysite                                            # Your custom migration module/classes.
    Source:
        Files:
            variable: mysite_file_migration                         # File migrations can use this to set source files path.
            dir: /var/www/vhosts/mysite-old.drupal.dev/files        # Provide the path to the source files folder.
    Groups:                                                         # We can migrate groups, in order...
        - users
        - terms
        - default
    Migrations:                                                     # ... and/or also run individual migrations, in order.
        - Roles
        - Users

# Post-steps.
Post:
    Commands:                                                       # Drush commands to run after we're finished.
        - en mysite_menus                                           # Install menus after migration, for example.
        - sqlq "UPDATE block SET status = 0 WHERE module != 'system' OR delta != 'main'"
        - dis mysite_block_install                                  # THis module might be hidden from the UI.
